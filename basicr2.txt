# ðŸ“¥ LECTURA DE DATOS
df <- read.csv("archivo.csv", sep = ",", header = TRUE)
# Si es Excel
library(readxl)
df <- read_excel("archivo.xlsx")

# ðŸ“Š ANÃLISIS UNIVARIADO
summary(df)
library(DataExplorer)
plot_intro(df)
plot_histogram(df)

# ðŸ” ANÃLISIS BIVARIADO
# NumÃ©rica vs CategÃ³rica
boxplot(Income ~ Gender, data = df)
# NumÃ©rica vs NumÃ©rica
plot(df$Age, df$Income)
# CategÃ³rica vs CategÃ³rica
table(df$Gender, df$Default)

# ðŸ› ï¸ IMPUTACIÃ“N DE DATOS
df$Income[is.na(df$Income)] <- mean(df$Income, na.rm = TRUE)
df$Income[is.na(df$Income)] <- median(df$Income, na.rm = TRUE)
library(mice)
df_imp <- mice(df, m=1, method='pmm')
df <- complete(df_imp)

# ðŸ”— MATRIZ DE CORRELACIÃ“N
library(corrplot)
cor_matrix <- cor(df[sapply(df, is.numeric)], use = "complete.obs")
corrplot(cor_matrix, method = "color")

# ðŸ”‚ PARTICIÃ“N DE DATOS
set.seed(123)
library(caret)
particion <- createDataPartition(df$target, p = 0.7, list = FALSE)
train <- df[particion, ]
test <- df[-particion, ]

# ðŸ”„ VALIDACIÃ“N CRUZADA (K-FOLD)
ctrl <- trainControl(method = "cv", number = 5)
modelo <- train(target ~ ., data = train, method = "glm", trControl = ctrl)

# ðŸŒ³ ÃRBOLES DE DECISIÃ“N
library(rpart)
arbol <- rpart(target ~ ., data = train, method = "class")
library(rpart.plot)
rpart.plot(arbol)

# ðŸ“‰ REGRESIÃ“N LOGÃSTICA
modelo <- glm(target ~ ., data = train, family = "binomial")
summary(modelo)

# âœ… MATRIZ DE CONFUSIÃ“N
library(caret)
pred <- predict(modelo, test, type = "response")
pred_clas <- ifelse(pred > 0.5, 1, 0)
confusionMatrix(as.factor(pred_clas), as.factor(test$target))

# ðŸ“ˆ CURVA ROC Y AUC
library(pROC)
roc_obj <- roc(test$target, pred)
plot(roc_obj)
auc(roc_obj)

# ðŸ“ WOE E IV (para scoring)
library(scorecard)
bins <- woebin(df, y = "target")
df_woe <- woebin_ply(df, bins)

# ðŸ“¦ EXPORTAR DATOS
write.csv(df, "salida.csv", row.names = FALSE)
